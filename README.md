# 代理池管理工具 (Proxy Pool Manager)

一个功能强大的代理IP管理工具，支持HTTP/HTTPS/SOCKS4/SOCKS5协议，提供代理的爬取、验证、管理和提取功能。

## 功能特点

### 🔄 多协议支持
- HTTP/HTTPS 代理
- SOCKS4 代理  
- SOCKS5 代理
- 自动协议检测

### 📊 智能管理
- **自动验证**: 检查代理可用性和响应时间
- **评分系统**: 基于稳定性动态评分（0-100分）
- **去重过滤**: 自动移除重复和无效代理
- **中断恢复**: 支持验证过程中断后继续
- **类型识别**: 自动识别代理协议类型

### 🌐 多源爬取
内置11个免费代理源：
1. proxy5.net
2. 89ip.cn
3. freevpnnode.com
4. 快代理 (kuaidaili.com)
5. ip3366.net
6. proxypool.scrape.center
7. proxy.scdn.io
8. proxyhub.me
9-11. GitHub免费代理列表 (HTTP/SOCKS5/HTTPS)

## 安装依赖

```bash
pip install requests
# 可选：用于异步爬取
pip install aiohttp
```

## 快速开始

### 基本使用

1. **运行程序**:
```bash
python proxies_pool.py
```

2. **主菜单选项**:
```
1: 加载并验证新代理
2: 检验并更新已有代理  
3: 提取代理(可指定数量,类型)
4: 查看代理池状态
```

### 功能详解

#### 1. 加载新代理
- **来自爬虫**: 从11个免费代理网站自动爬取
- **来自文件**: 从CSV文件导入代理列表
- **自动验证**: 新代理验证两次确保可用性

#### 2. 更新已有代理
- 定期验证代理池中代理的有效性
- 根据验证结果动态调整分数
- 自动移除失效代理（0分）

#### 3. 提取代理
- 按类型筛选: HTTP/HTTPS, SOCKS4, SOCKS5, 全部
- 按分数排序: 优先提取高分数稳定代理
- 支持保存到文件

#### 4. 状态查看
- 显示各类代理数量统计
- 按分数分布显示代理质量
- 总代理数量统计

## 文件结构

```
proxies/
├── proxies_pool.py          # 主程序
├── valid_proxies.csv        # 有效代理池（自动生成）
└── interrupt/               # 中断恢复文件目录
    ├── interrupted_proxies.csv
    ├── interrupted_load_proxies.csv
    └── interrupted_existing_proxies.csv
```

## 配置说明

### 主要配置参数

```python
# 输出文件路径
OUTPUT_FILE = "../proxies/valid_proxies.csv"

# 测试URL（验证代理用）
TEST_URL = "http://httpbin.org/ip"

# 超时时间（秒）
TIMEOUT = 6

# 最大并发数
MAX_WORKERS = 80

# 代理最大分数
MAX_SCORE = 100
```

### 代理池文件格式

```csv
Type,Proxy:Port,Score
http,192.168.1.1:8080,98
socks5,192.168.1.2:1080,95
```

## 使用示例

### 爬取并验证新代理
1. 选择主菜单选项 `1`
2. 选择来源 `1`（爬虫）
3. 选择代理源（1-11）
4. 程序自动爬取、过滤、验证并保存

### 从文件导入代理
1. 准备CSV文件（格式：`ip,port` 或 `ip:port`）
2. 选择主菜单选项 `1` → `2`
3. 输入文件路径
4. 选择代理类型或自动检测

### 提取高质量代理
```python
# 提取10个HTTP代理
proxies = extract_proxies_by_type(10, "http")

# 提取5个SOCKS5代理  
proxies = extract_proxies_by_type(5, "socks5")
```

## 中断恢复功能

程序支持三种中断场景的恢复：
- **爬取验证中断**: 自动保存进度，下次可继续
- **文件加载中断**: 导入文件时中断可恢复
- **代理池更新中断**: 验证现有代理时中断可恢复

按 `Ctrl+C` 可安全中断任何操作。

## 代理评分机制

- **有效代理**: +1分（最高100分）
- **超时代理**: 保持原分数（80分）
- **无效代理**: -1分（最低0分，自动移除）
- **新代理验证**: 初始98分（验证成功）

## 注意事项

1. **网络环境**: 确保测试URL可访问
2. **并发控制**: 根据网络情况调整 `MAX_WORKERS`
3. **文件权限**: 确保程序有写入权限
4. **代理质量**: 免费代理稳定性有限，建议定期更新

## 更新日志

### v1.0
- 多协议代理支持
- 智能评分系统
- 中断恢复功能
- 11个免费代理源
- 批量验证和管理

## 许可证

本项目仅供学习和研究使用,爬虫部分仅供参考，请遵守相关法律法规。

---

**提示**: 建议将程序放在 `proxies` 文件夹下运行，或相应修改配置中的文件路径。
